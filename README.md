# 多功能计算器

* 此代码是作者出于兴趣爱好自己编写的。转载请注明。

* 作者的邮箱：contactwangpai@163.com

---

分支 M # 最新版本 ` M.3.0 ` 支持的功能：（以用户的角度）

1. 操作数支持多位运算。一个操作数可以是十位数或者更高位数的数

2. 操作数支持小数点、负数，运算结果支持显示小数、负数

3. 表达式可以含多个操作数、多个运算符，还可以带括号

4. 对输入的表达式提供实时自动语法检查与错误定位，并支持检查后的修改

5. 对输入无误的表达式进行实时自动计算，并可选显示完整详细的计算过程。

6. 使用 GUI 界面来显示上面的表达式输入、报错显示、运算过程

7. 提供界面按钮以供输入。按钮功能包含文本全选、光标左移与右移，选中文本的删除、输入替换、击键变色

8. 提供右键菜单以供撤消、重做、剪切、复制、粘贴、删除、全选

9. 支持键盘输入

10. 提供 Windows 下免安装 JDK 直接运行的 EXE 文件。此 EXE 程序拥有程序名、程序图标

    （出于时间成本，本次版本暂没有制作 EXE）

---



# 本次更新介绍

<p align="right">——2021年9月27日</p>

代码介绍：

&emsp;&emsp;本工程是在 本分支的上一版本的基础之上进行的升级。

&emsp;&emsp;相对于版本 ` M.2.3 `，本版本 ` M.3.0 ` 的改进主要有：

* 使用 JavaFX 技术重制界面，去掉了原来的 Java Swing 技术。

* 使用最新的 Java 17 作为运行环境，而上个版本的为 Java 11。

* 去掉了原来被迫使用、深入到 Java Swing 内部修改界面的反射，大大减少了程序启动时间，使用启动时间从原来的 5 秒以上降至 5 秒以内。

  但由于使用的是 Java 17 的 Java FX 17，生成的 JAR 包大小急剧膨胀，大小从上个版本的 3.93MB 增至 12.6MB，但内存占用增至不大，和之前持平。

* 将原来的父模块 `calculator-project` 重命名为 `calculator-windows`。 将原来的子模块 `calculator-core` 分解为了三个平行模块：`calculator-entrance`、`calculator-ui`、`calculator-backend`。

* 对于 JavaFX 技术与 Spring 技术不相容的问题，使用了适配器模式：对每个 JavaFX 组件，引入了一个 Linker 类，用于连接每个 JavaFX 组件与 Spring Bean。

* 增加了按钮的击键变色功能。

---

&emsp;&emsp;本版本的已知不足与预想的改进方案：

* 程序运行时会发生偶发卡顿（此时按键失效、界面不动、光标符号异常）。

  猜测是因为 UI 线程负担过大，造成阻塞死锁。或者是本电脑运行时间过长，且同时长期运行的程序过多。

  未来尝试使用多线程技术，将后台操作移至其它线程。

---

&emsp;&emsp;未来版本可能会实现的功能：

* 提供文本的清空、复制、剪切、粘贴按钮

* 提供文本的撤销和恢复快捷键

---

* 本项目使用的开发环境：
  - JDK 17 2021-09-14
  - JavaFX 17-ea+11
  - IntelliJ IDEA 2021.2.2 (Ultimate Edition)

---

* 核心 Java 语言代码文件：

* 程序启动入口 API：

  >  模块 `calculator-entrance` 中的
  >
  >  > 包`org.wangpai.calculator`中的
  >  >
  >  > > 类 `CalculatorApplication` 中的
  >  > >
  >  > > > 静态方法 `main`

---

* 总计：7299
* Java 代码：6693
  - 测试代码：1791

    + JUnit：本次未统计
* ML、CSS 代码：606

  - FXML：206
  - CSS：33
  - Spring 配置：13
  - pom 文件：354

---

* 程序屏幕输入示例：`2334.623*6345-234/1234+234*(254-45.242)=`

---

* 一些程序截图片段：

---

![](img_md/202108927_1.png)

---

![](img_md/202108927_2.png)

---

![](img_md/202108927_3.png)

---
